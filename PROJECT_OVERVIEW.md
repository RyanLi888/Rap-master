# RAPIER 项目概览

## 🎯 项目简介

RAPIER (Robust Adversarial Perturbation In EEG Recognition) 是一个用于脑电图(EEG)信号分类的深度学习系统。该系统结合了自编码器、对抗生成网络和协同教学等先进技术，在处理噪声标签和对抗样本方面表现出色。

## 📊 性能指标

- **F1分数**: 0.7911 (最优配置)
- **准确率**: 96.40%
- **召回率**: 75.00%
- **精确率**: 83.71%

## 🏗️ 系统架构

### 核心组件

1. **AE (AutoEncoder)**: LSTM-based自编码器
   - 功能: 特征提取和降维
   - 输入: 原始EEG信号
   - 输出: 32维特征向量

2. **MADE (Multi-scale Adversarial Discriminative Estimator)**: 多尺度对抗判别器
   - 功能: 数据清理和标签修正
   - 技术: 集成多种传统ML模型进行投票
   - 输出: 清理后的训练数据

3. **GAN (Generative Adversarial Network)**: 生成对抗网络
   - 功能: 数据增强
   - 生成: 高质量的对抗样本
   - 策略: 使用最优parallel=1配置

4. **Classifier**: Co-teaching分类器
   - 技术: 双MLP协同训练
   - 功能: 处理噪声标签，提高鲁棒性
   - 损失函数: Co-teaching loss

### 数据流程

```
原始EEG数据 → AE特征提取 → MADE数据清理 → GAN数据增强 → Co-teaching分类 → 最终预测
```

## 🔧 技术特性

### 创新点

1. **多阶段处理流程**: 逐步提升数据质量
2. **对抗样本生成**: 增强模型泛化能力  
3. **协同教学**: 有效处理噪声标签
4. **确定性配置**: 保证结果可重复性

### 优化配置

- **随机种子**: 经过系统验证的最优种子组合
- **parallel参数**: 使用parallel=1获得最佳性能
- **数据采样**: 优化的GAN数据使用策略

## 📁 项目结构

```
Rap-master/
├── 📁 main/                    # 主程序
│   └── 📄 main.py             # 优化的主程序
├── 📁 seed_search/            # 种子搜索 (独立模块)
│   ├── 📄 seed_search_main.py # 种子搜索主程序
│   ├── 📄 README.md           # 种子搜索文档
│   └── 📄 *.py               # 其他工具
├── 📁 AE/                     # 自编码器模块
├── 📁 MADE/                   # MADE模型模块
├── 📁 Classifier/             # 分类器模块
├── 📁 utils/                  # 工具模块
├── 📁 data/                   # 数据目录
├── 📁 seed_data/             # 种子搜索结果
├── 📄 README.md               # 主文档
└── 📄 PROJECT_OVERVIEW.md     # 项目概览 (本文件)
```

## 🚀 使用指南

### 快速开始

```bash
# 1. 进入主程序目录
cd main

# 2. 运行主程序 (使用最优配置)
python main.py
```

### 高级用法

```bash
# 种子搜索 (可选)
cd seed_search
python seed_search_main.py --seeds 42 123 1234
```

## 📈 实验结果

### 配置对比

| 配置 | parallel | F1分数 | 提升 | 说明 |
|------|----------|--------|------|------|
| 原始 | 5 | 0.7699 | 基准 | 使用多个GAN文件的头部片段 |
| **最优** | **1** | **0.7911** | **+0.0212** | **使用单个GAN文件的完整数据** |
| 策略A | 5 | 0.7720 | +0.0021 | 使用多个GAN文件的中后部分 |

### 关键发现

1. **质量优于多样性**: 高质量的完整数据比多样化的片段数据效果更好
2. **数据连贯性重要**: 连续的特征块比分散的小片段学习效果更好
3. **GAN生成质量**: 后期生成的样本通常比初期样本质量更高

## 🔬 技术细节

### 算法原理

1. **自编码器**: 使用LSTM捕获时序特征
2. **MADE**: 基于密度估计的异常检测
3. **GAN**: 条件生成对抗网络
4. **Co-teaching**: 双网络互教学习

### 损失函数

- **AE损失**: 重构误差 + 正则化项
- **MADE损失**: 对数似然估计
- **GAN损失**: 对抗损失 + 特征匹配损失
- **分类器损失**: Co-teaching损失函数

## 📊 性能分析

### 优势

- ✅ 高准确率和F1分数
- ✅ 强鲁棒性 (处理噪声标签)
- ✅ 可重复性 (确定性配置)
- ✅ 模块化设计 (易于扩展)

### 适用场景

- 🧠 脑电图信号分类
- 📊 噪声标签数据处理
- 🎯 时序数据分析
- 🔒 对抗样本检测

## 🛠️ 开发指南

### 代码结构

- **模块化设计**: 每个组件独立可测试
- **配置驱动**: 通过配置文件控制行为
- **文档完整**: 详细的代码注释和文档

### 扩展建议

1. **新的特征提取器**: 可以替换或扩展AE模块
2. **不同的生成模型**: 可以尝试VAE、Diffusion等
3. **其他分类算法**: 可以集成Transformer等新架构
4. **多模态融合**: 支持多种生理信号

## 📚 相关资源

### 理论基础

- 对抗训练理论
- 协同教学算法
- 生成对抗网络
- 噪声标签学习

### 技术栈

- **深度学习**: PyTorch
- **数据处理**: NumPy, Pandas
- **机器学习**: Scikit-learn, XGBoost
- **可视化**: Matplotlib (可选)

## 🤝 贡献指南

### 如何贡献

1. **报告问题**: 提交Issue描述遇到的问题
2. **提出改进**: 建议新的优化方案
3. **代码贡献**: 提交Pull Request
4. **文档完善**: 改进项目文档

### 开发规范

- 遵循PEP 8代码风格
- 添加适当的注释和文档
- 确保代码的可重现性
- 提供充分的测试

## 📄 许可证

请参考项目根目录的LICENSE文件。

## 📞 联系方式

如有问题或建议，请通过以下方式联系：
- 项目Issues
- 开发团队邮箱
- 技术讨论群

---

**项目版本**: 2.0 (优化版)  
**最后更新**: 2025年9月21日  
**维护状态**: 积极维护  
**稳定性**: 生产就绪
